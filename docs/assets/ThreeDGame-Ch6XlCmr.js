import{r as h,j as d}from"./index-GrET7jio.js";import{C as V,V as R,E as W,S as q,P as O,W as U,B as G,M as N,a as Q,b as Y,A as B}from"./three.module-CBEvh3C0.js";const p=new W(0,0,0,"YXZ"),v=new R,K={type:"change"},X={type:"lock"},Z={type:"unlock"},S=.002,_=Math.PI/2;class J extends V{constructor(e,o=null){super(e,o),this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,this._onMouseMove=$.bind(this),this._onPointerlockChange=ee.bind(this),this._onPointerlockError=te.bind(this),this.domElement!==null&&this.connect(this.domElement)}connect(e){super.connect(e),this.domElement.ownerDocument.addEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this._onPointerlockError)}disconnect(){this.domElement.ownerDocument.removeEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this._onPointerlockError)}dispose(){this.disconnect()}getObject(){return console.warn("THREE.PointerLockControls: getObject() has been deprecated. Use controls.object instead."),this.object}getDirection(e){return e.set(0,0,-1).applyQuaternion(this.object.quaternion)}moveForward(e){if(this.enabled===!1)return;const o=this.object;v.setFromMatrixColumn(o.matrix,0),v.crossVectors(o.up,v),o.position.addScaledVector(v,e)}moveRight(e){if(this.enabled===!1)return;const o=this.object;v.setFromMatrixColumn(o.matrix,0),o.position.addScaledVector(v,e)}lock(e=!1){this.domElement.requestPointerLock({unadjustedMovement:e})}unlock(){this.domElement.ownerDocument.exitPointerLock()}}function $(a){if(this.enabled===!1||this.isLocked===!1)return;const e=this.object;p.setFromQuaternion(e.quaternion),p.y-=a.movementX*S*this.pointerSpeed,p.x-=a.movementY*S*this.pointerSpeed,p.x=Math.max(_-this.maxPolarAngle,Math.min(_-this.minPolarAngle,p.x)),e.quaternion.setFromEuler(p),this.dispatchEvent(K)}function ee(){this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(X),this.isLocked=!0):(this.dispatchEvent(Z),this.isLocked=!1)}function te(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}const ie=()=>{const a=h.useRef(null),e=h.useRef(null),o=h.useRef(null),[f,D]=h.useState(!0),n=h.useRef({w:!1,a:!1,s:!1,d:!1,space:!1,control:!1});h.useEffect(()=>{if(!a.current||f)return;const I=a.current,l=new q,r=new O(75,window.innerWidth/window.innerHeight,.1,1e3),c=new U({antialias:!0});c.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(c.domElement),r.updateProjectionMatrix();const g=new G,L=new N({color:65280}),E=new Q(g,L);l.add(E),r.position.z=5,r.lookAt(E.position),r.fov=60,r.updateProjectionMatrix();const b=new Y(16777215,1,100);b.position.set(10,10,10),l.add(b);const T=new B(16777215,.5);l.add(T);const s=new J(r,document.body);l.add(s.object),e.current={scene:l,camera:r,renderer:c,cube:E,controls:s};const m=((t,i,F,H={})=>{const w=document.createElement(t);return w.className=i,w.innerText=F,Object.assign(w.style,H),w})("div","indicator activate","Click Here to Activate Viewport");m.style.cssText="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.9); color: white; padding: 20px; border-radius: 10px; font-size: 18px; text-align: center; z-index: 1000; cursor: pointer;",I.appendChild(m),/Mobi|Android/i.test(navigator.userAgent)&&(m.innerText="3D Game is not supported on mobile.");const u=.05,x=()=>{m&&(m.style.display=document.pointerLockElement===document.body?"none":"block")},k=()=>{document.pointerLockElement||s.lock()},y=()=>{console.log("Pointer locked")},P=()=>{console.log("Pointer unlocked")},M=t=>{const i=t.key.toLowerCase();i===" "?n.current.space=!0:i==="control"?n.current.control=!0:i in n.current&&(n.current[i]=!0)},C=t=>{const i=t.key.toLowerCase();i===" "?n.current.space=!1:i==="control"?n.current.control=!1:i in n.current&&(n.current[i]=!1)},j=()=>{c.setSize(window.innerWidth,window.innerHeight),r.aspect=window.innerWidth/window.innerHeight,r.updateProjectionMatrix()};document.addEventListener("pointerlockchange",x),document.addEventListener("click",k),s.addEventListener("lock",y),s.addEventListener("unlock",P),window.addEventListener("keydown",M),window.addEventListener("keyup",C),window.addEventListener("resize",j);const A=()=>{if(o.current=requestAnimationFrame(A),s.isLocked){const t=new R;n.current.w&&(t.z-=u),n.current.s&&(t.z+=u),n.current.a&&(t.x-=u),n.current.d&&(t.x+=u),n.current.space&&(t.y+=u),n.current.control&&(t.y-=u),t.length()>0&&(t.applyQuaternion(r.quaternion),s.object.position.add(t))}c.render(l,r)};return A(),()=>{o.current&&cancelAnimationFrame(o.current),document.removeEventListener("pointerlockchange",x),m.removeEventListener("click",k),document.removeEventListener("click",k),s.removeEventListener("lock",y),s.removeEventListener("unlock",P),window.removeEventListener("keydown",M),window.removeEventListener("keyup",C),window.removeEventListener("resize",j),document.body.contains(c.domElement)&&document.body.removeChild(c.domElement),g.dispose(),L.dispose(),c.dispose()}},[f]);const z=()=>{D(!1)};return d.jsxs("div",{className:"three-d-game-container",children:[f&&d.jsx("div",{id:"instructions-overlay",children:d.jsxs("div",{id:"instructions-box",children:[d.jsx("h2",{children:"Movement Controls"}),d.jsx("p",{children:"Click: activate viewport. Esc: deactivate viewport. W,S: forward/back. A/D: left/right. Space/Ctrl: up/down. Move mouse to rotate camera."}),d.jsx("button",{id:"accept-btn",onClick:z,children:"Accept"})]})}),d.jsx("div",{ref:a,style:{width:"100%",height:"100vh",position:"relative",overflow:"hidden"}})]})};export{ie as default};
//# sourceMappingURL=ThreeDGame-Ch6XlCmr.js.map
