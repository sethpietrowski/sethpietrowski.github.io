{"version":3,"file":"ThreeDGame-CUFssVDp.js","sources":["../../src/pages/ThreeDGame.jsx"],"sourcesContent":["import {useEffect, useRef, useState } from 'react';\r\nimport * as THREE from 'three';\r\nimport '../styles.css';\r\n\r\nconst ThreeDGame = () => {\r\n  const gameAreaRef = useRef(null);\r\n  const sceneRef = useRef(null);\r\n  const animationIdRef = useRef(null);\r\n  const rendererRef = useRef(null);\r\n  const controlsRef = useRef(null);\r\n  const [showOverlay, setShowOverlay] = useState(true);\r\n  const [isPointerLocked, setIsPointerLocked] = useState(false);\r\n\r\n  const keysRef = useRef({\r\n    w: false,\r\n    a: false,\r\n    s: false,\r\n    d: false,\r\n    space: false,\r\n    control: false\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!gameAreaRef.current || showOverlay) return;\r\n\r\n    const gameArea = gameAreaRef.current;\r\n\r\n    //clear existing content\r\n    gameArea.innerHTML = '';\r\n\r\n    const scene = new THREE.Scene();\r\n    const camera = new THREE.PerspectiveCamera(75, gameArea.clientWidth / gameArea.clientHeight, 0.1, 1000);\r\n    const renderer = new THREE.WebGLRenderer({ antialias: true});\r\n    \r\n    renderer.setSize(gameArea.clientWidth, gameArea.clientHeight);\r\n    gameArea.appendChild(renderer.domElement);\r\n    rendererRef.current = renderer;\r\n\r\n    // create cube, add to scene\r\n    const geometry = new THREE.BoxGeometry();\r\n    const material = new THREE.MeshStandardMaterial({ color: 0x00ff00 });\r\n    const cube = new THREE.Mesh(geometry, material);\r\n    scene.add(cube);\r\n\r\n    camera.position.set(0, 0, 5);\r\n    camera.lookAt(cube.position);\r\n    camera.fov = 60;\r\n    camera.updateProjectionMatrix();\r\n\r\n    //new directional lighting source\r\n    const light = new THREE.PointLight(0xffffff, 1, 100);\r\n    light.position.set(10,10,10);\r\n    scene.add(light);\r\n\r\n    const ambientLight = new THREE.AmbientLight(0xffffff, 0.5); // soft white light\r\n    scene.add(ambientLight);\r\n\r\n    const createPointerLockControls = () => {\r\n      const controls = {\r\n        camera: camera,\r\n        domElement: renderer.domElement,\r\n        isLocked: false,\r\n\r\n        lock: () => {\r\n          renderer.domElement.requestPointerLock();\r\n        },\r\n\r\n        unlock: () => {\r\n          document.exitPointerLock();\r\n        }\r\n      };\r\n\r\n      return controls;\r\n    }\r\n\r\n    const controls = createPointerLockControls();\r\n    controlsRef.current = controls;\r\n\r\n    sceneRef.current = { scene, camera, renderer, cube, controls };\r\n\r\n    const activateIndicator = document.createElement('div');\r\n    activateIndicator.className = 'pointer-lock-indicator';\r\n    activateIndicator.innerText = /Mobi|Android/i.test(navigator.userAgent)\r\n      ? '3D Game is not supported on mobile.' \r\n      : 'Click Here to Activate Viewport';\r\n    activateIndicator.style.display = isPointerLocked ? 'none' : 'block';\r\n    \r\n    gameArea.appendChild(activateIndicator);\r\n    \r\n    const movementSpeed = 0.05;\r\n    let mouseX = 0;\r\n    let mouseY = 0;\r\n\r\n    const handlePointerLockChange = () => {\r\n      const locked = document.pointerLockElement === renderer.domElement;\r\n      controls.isLocked = locked;\r\n      setIsPointerLocked(locked);\r\n      activateIndicator.style.display = locked ? 'none' : 'block';\r\n\r\n      if (locked) {\r\n        document.body.style.cursor = 'none';\r\n      } else {\r\n        document.body.style.cursor = 'default';\r\n      }\r\n    };\r\n\r\n    const handleClick = (event) => {\r\n      if (event.target === activateIndicator && !controls.isLocked) {\r\n        controls.lock();\r\n      }\r\n    };\r\n\r\n    const handleMouseMove = (event) => {\r\n      if (controls.isLocked) {\r\n        const movementX = event.movementX || 0;\r\n        const movementY = event.movementY || 0;\r\n\r\n        mouseX -= movementX * 0.002;\r\n        mouseY -= movementY * 0.002;\r\n        mouseY = Math.max(-Math.PI/2, Math.min(Math.PI/2, mouseY));\r\n\r\n        camera.rotation.order = 'YXZ';\r\n        camera.rotation.x = mouseY;\r\n        camera.rotation.y = mouseX;\r\n      }\r\n    }\r\n\r\n    const handleKeyDown = (event) => {\r\n      const key = event.key.toLowerCase();\r\n      if (key === \" \") {\r\n        event.preventDefault;\r\n        keysRef.current.space = true;\r\n      } else if (key === \"control\") {\r\n        keysRef.current.control = true;\r\n      } else if (key in keysRef.current) {\r\n        keysRef.current[key] = true;\r\n      }\r\n    };\r\n\r\n    const handleKeyUp = (event) => {\r\n      const key = event.key.toLowerCase();\r\n      if (key === \" \") {\r\n        keysRef.current.space = false;\r\n      } else if (key === \"control\") {\r\n        keysRef.current.control = false;\r\n      } else if (key in keysRef.current) {\r\n        keysRef.current[key] = false;\r\n      }\r\n    };\r\n\r\n    const handleResize = () => {\r\n      const width = gameArea.clientWidth;\r\n      const height = gameArea.clientHeight;\r\n      renderer.setSize(width, height);\r\n      camera.aspect = width / height;\r\n      camera.updateProjectionMatrix();\r\n    };\r\n\r\n    document.addEventListener(\"pointerlockchange\", handlePointerLockChange);\r\n    activateIndicator.addEventListener(\"click\", handleClick);\r\n    document.addEventListener(\"mousemove\", handleMouseMove);\r\n    window.addEventListener(\"keydown\", handleKeyDown);\r\n    window.addEventListener(\"keyup\", handleKeyUp);\r\n    window.addEventListener(\"resize\", handleResize);\r\n\r\n    const animate = () => {\r\n      animationIdRef.current = requestAnimationFrame(animate);\r\n\r\n      if (controls.isLocked) {\r\n        const direction = new THREE.Vector3();\r\n        const cameraDirection = new THREE.Vector3();\r\n        camera.getWorldDirection(cameraDirection);\r\n\r\n        const right = new THREE.Vector3();\r\n        right.crossVectors(cameraDirection, camera.up).normalize();\r\n        \r\n        if (keysRef.current.w) {\r\n          direction.add(cameraDirection.clone().multiplyScalar(movementSpeed));\r\n        }\r\n\r\n        if (keysRef.current.s) {\r\n          direction.add(cameraDirection.clone().multiplyScalar(-movementSpeed));\r\n        }\r\n\r\n        if (keysRef.current.a) {\r\n          direction.add(right.clone().multiplyScalar(-movementSpeed));\r\n        }\r\n\r\n        if (keysRef.current.d) {\r\n          direction.add(right.clone().multiplyScalar(movementSpeed));\r\n        }\r\n\r\n        if (keysRef.current.space) {\r\n          direction.y += movementSpeed;\r\n        }\r\n\r\n        if (keysRef.current.control) {\r\n          direction.y -= movementSpeed;\r\n        }\r\n\r\n        camera.position.add(direction);\r\n      }\r\n\r\n      renderer.render(scene, camera);\r\n    };\r\n\r\n    animate();\r\n\r\n    return () => {\r\n      if (animationIdRef.current) {\r\n        cancelAnimationFrame(animationIdRef.current);\r\n      }\r\n\r\n      document.removeEventListener(\"pointerlockchange\", handlePointerLockChange);\r\n      activateIndicator.removeEventListener(\"click\", handleClick);\r\n      document.removeEventListener(\"mousemove\", handleMouseMove);\r\n      document.removeEventListener(\"keydown\", handleKeyDown);\r\n      document.removeEventListener(\"keyup\", handleKeyUp);\r\n      window.removeEventListener(\"resize\", handleResize);\r\n\r\n\r\n      document.body.style.cursor = 'default';\r\n\r\n      if (gameArea && gameArea.contains(activateIndicator)) {\r\n        gameArea.removeChild(activateIndicator);\r\n      }\r\n\r\n      if (rendererRef.current) {\r\n        rendererRef.current.dispose();\r\n      }\r\n\r\n      geometry.dispose();\r\n      material.dispose();\r\n    };\r\n  }, [showOverlay]);\r\n  \r\n  const handleAccept = () => {\r\n    setShowOverlay(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"three-d-game-container\">\r\n      {showOverlay && (\r\n        <div id=\"instructions-overlay\">\r\n          <div id=\"instructions-box\">\r\n            <h2>Movement Controls</h2>\r\n            <p>\r\n              Click: activate viewport. Esc: deactivate viewport. W,S: forward/back. \r\n              A/D: left/right. Space/Ctrl: up/down. Move mouse to rotate camera.\r\n            </p>\r\n            <button id=\"accept-btn\" onClick={handleAccept}>Accept</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n      <div ref={gameAreaRef} style={{ width: '100%', height: '100vh', position: 'relative', overflow: 'hidden'}}></div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ThreeDGame;"],"names":["ThreeDGame","gameAreaRef","useRef","sceneRef","animationIdRef","rendererRef","controlsRef","showOverlay","setShowOverlay","useState","isPointerLocked","setIsPointerLocked","keysRef","useEffect","gameArea","scene","THREE.Scene","camera","THREE.PerspectiveCamera","renderer","THREE.WebGLRenderer","geometry","THREE.BoxGeometry","material","THREE.MeshStandardMaterial","cube","THREE.Mesh","light","THREE.PointLight","ambientLight","THREE.AmbientLight","controls","activateIndicator","movementSpeed","mouseX","mouseY","handlePointerLockChange","locked","handleClick","event","handleMouseMove","movementX","movementY","handleKeyDown","key","handleKeyUp","handleResize","width","height","animate","direction","THREE.Vector3","cameraDirection","right","handleAccept","jsxs","jsx"],"mappings":"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"}