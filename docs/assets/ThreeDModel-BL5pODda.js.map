{"version":3,"file":"ThreeDModel-BL5pODda.js","sources":["../../src/pages/ThreeDModel.jsx"],"sourcesContent":["import {useEffect, useRef } from \"react\";\r\nimport * as THREE from 'three';\r\nimport '../styles.css'\r\n\r\nconst ThreeDModel = () => {\r\n  const gameAreaRef = useRef(null);\r\n  const sceneRef = useRef(null);\r\n  const animationIdRef = useRef(null);\r\n  const stateRef = useRef({\r\n    isActive: false,\r\n    targetX: 0,\r\n    targetY: 0,\r\n    rotationX: 0,\r\n    rotationY: 0,\r\n    moveForward: false,\r\n    moveBackward: false,\r\n    moveLeft: false,\r\n    moveRight: false,\r\n    moveUp: false,\r\n    moveDown: false,\r\n    isRotating: false,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!gameAreaRef.current) return;\r\n\r\n    const gameArea = gameAreaRef.current;\r\n\r\n    const scene = new THREE.Scene();\r\n    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);\r\n    const renderer = new THREE.WebGLRenderer({ antialias: true});\r\n    renderer.setSize(window.innerWidth, window.innerHeight);\r\n    gameArea.appendChild(renderer.domElement);\r\n\r\n    // create cube, add to scene\r\n    const geometry = new THREE.TorusKnotGeometry();\r\n\r\n    const vertexShader = `\r\n      varying vec3 vNormal;\r\n      void main() {\r\n        vNormal = normalize(normalMatrix * normal);\r\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n      }`;\r\n\r\n    const fragmentShader = `\r\n      varying vec3 vNormal;\r\n      void main() {\r\n        vec3 lightDirection = normalize(vec3(-1.0,1.0,0.0)); //light location is to left and above camera\r\n        float intensity = pow(max(dot(vNormal, lightDirection), 0.0), 2.5); // make edges glow\r\n        gl_FragColor = vec4(0.0, intensity, 0.0, 1.0); // greenish glow on edges\r\n      }`;\r\n\r\n    const material = new THREE.ShaderMaterial({ \r\n      vertexShader, \r\n      fragmentShader, \r\n      wireframe: false, \r\n    });\r\n    const cube = new THREE.Mesh(geometry, material);\r\n    scene.add(cube);\r\n\r\n    camera.position.z = 5;\r\n\r\n    const ambientLight = new THREE.AmbientLight(0xffffff, 0.7);\r\n    scene.add(ambientLight);\r\n    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.7);\r\n    directionalLight.position.set(-1, -1, -1).normalize();\r\n    scene.add(directionalLight);\r\n    \r\n    //store references\r\n    sceneRef.current = { scene, camera, renderer, cube };\r\n\r\n    const movementSpeed = 0.1;\r\n    const rotationSpeed = 0.001; \r\n\r\n    const activateIndicator = document.createElement('div');\r\n    const exitIndicator = document.createElement('div');\r\n    activateIndicator.className = 'indicator activate';\r\n    activateIndicator.style.cssText = 'position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.9); color: white; padding: 20px; border-radius: 10px; font-size: 18px; text-align: center; z-index: 1000; cursor: pointer;';\r\n    activateIndicator.innerText = \"Click Here to Activate Viewport\";\r\n    exitIndicator.className = 'indicator exit';\r\n    exitIndicator.style.cssText = 'position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.9); color: white; padding: 20px; border-radius: 10px; font-size: 18px; text-align: center; z-index: 1000; display: none;';\r\n    exitIndicator.innerText = \"Press Esc to Exit Viewport\";\r\n    gameArea.appendChild(activateIndicator);\r\n    gameArea.appendChild(exitIndicator);\r\n\r\n    const handleGameAreaClick = (event) => {\r\n      if (event.target === activateIndicator && !stateRef.current.isActive) {\r\n        stateRef.current.isActive = true;\r\n        activateIndicator.style.display = 'none';\r\n        exitIndicator.style.display = 'block';\r\n      }\r\n    };\r\n\r\n    const handleKeyDown = (event) => {\r\n      if (event.key === 'Escape' && stateRef.current.isActive) {\r\n        stateRef.current.isActive = false;\r\n        activateIndicator.style.display = 'block';\r\n        exitIndicator.style.display = 'none';\r\n        return;\r\n      }\r\n\r\n      if (stateRef.current.isActive) {\r\n        switch (event.key) {\r\n          case 'w': stateRef.current.moveForward = true; break;\r\n          case 's': stateRef.current.moveBackward = true; break;\r\n          case 'a': stateRef.current.moveLeft = true; break;\r\n          case 'd': stateRef.current.moveRight = true; break;\r\n          case ' ': stateRef.current.moveUp = true; break;\r\n          case 'Control': stateRef.current.moveDown = true; break;\r\n          case 'ArrowUp': cube.position.y += 1; break;\r\n          case 'ArrowDown': cube.position.y -= 1; break;\r\n          case 'ArrowLeft': cube.position.x -= 1; break;\r\n          case 'ArrowRight': cube.position.x += 1; break;\r\n        }\r\n      }\r\n    };\r\n\r\n    const handleKeyUp = (event) => {\r\n      switch (event.key) {\r\n        case 'w': stateRef.current.moveForward = false; break;\r\n        case 's': stateRef.current.moveBackward = false; break;\r\n        case 'a': stateRef.current.moveLeft = false; break;\r\n        case 'd': stateRef.current.moveRight = false; break;\r\n        case ' ': stateRef.current.moveUp = false; break;\r\n        case 'Control': stateRef.current.moveDown = false; break;\r\n      }\r\n    };\r\n\r\n    const handleMouseDown = (event) => {\r\n      if (stateRef.current.isActive && event.button === 0) {\r\n        stateRef.current.isRotating = true;\r\n      }\r\n    };\r\n\r\n    const handleMouseUp = (event) => {\r\n      if (event.button === 0) {\r\n        stateRef.current.isRotating = false;\r\n      }\r\n    };\r\n\r\n    const handleMouseMove = (event) => {\r\n      if (stateRef.current.isActive && stateRef.current.isRotating) {\r\n        const deltaX = event.movementX || 0;\r\n        const deltaY = event.movementY || 0;\r\n        stateRef.current.rotationX += deltaY * rotationSpeed; \r\n        stateRef.current.rotationY += deltaX * rotationSpeed;\r\n      }\r\n    };\r\n\r\n    const handleResize = () => {\r\n      renderer.setSize(window.innerWidth, window.innerHeight);\r\n      camera.aspect = window.innerWidth / window.innerHeight;\r\n      camera.updateProjectionMatrix();\r\n    };\r\n\r\n    activateIndicator.addEventListener('click', handleGameAreaClick);\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    window.addEventListener('keyup', handleKeyUp);\r\n    window.addEventListener('mousedown', handleMouseDown);\r\n    window.addEventListener('mouseup', handleMouseUp);\r\n    window.addEventListener('mousemove', handleMouseMove);\r\n    window.addEventListener('resize', handleResize);\r\n\r\n    //animation functions\r\n    const adjustRotation = (deltaTime) => {\r\n      if (stateRef.current && stateRef.current.isRotating) {\r\n        const qx = new THREE.Quaternion();\r\n        const qy = new THREE.Quaternion();\r\n\r\n        qy.setFromAxisAngle(new THREE.Vector3(0, 1, 0), stateRef.current.rotationY);\r\n        qx.setFromAxisAngle(new THREE.Vector3(1, 0, 0), stateRef.current.rotationX);\r\n        \r\n        cube.quaternion.multiplyQuaternions(qy, cube.quaternion);\r\n        cube.quaternion.multiplyQuaternions(qx, cube.quaternion);\r\n        \r\n        stateRef.current.rotationX *= 0.9;\r\n        stateRef.current.rotationY *= 0.9;\r\n      }\r\n    };\r\n    \r\n    let lastTime = performance.now();\r\n\r\n    const animate = () => {\r\n      animationIdRef.current = requestAnimationFrame(animate);\r\n\r\n      const now = performance.now();\r\n      const deltaTime = (now - lastTime) / 1000;\r\n      lastTime = now;\r\n\r\n      if (stateRef.current && stateRef.current.isActive) {\r\n        adjustRotation(deltaTime);\r\n\r\n        if (stateRef.current.moveForward) cube.position.z += movementSpeed;\r\n        if (stateRef.current.moveBackward) cube.position.z -= movementSpeed;\r\n        if (stateRef.current.moveLeft) cube.position.x += movementSpeed;\r\n        if (stateRef.current.moveRight) cube.position.x -= movementSpeed;\r\n        if (stateRef.current.moveUp) cube.position.y -= movementSpeed;\r\n        if (stateRef.current.moveDown) cube.position.y += movementSpeed;\r\n      }\r\n\r\n      renderer.render(scene, camera);\r\n    }\r\n\r\n    animate();\r\n\r\n    //clean up function\r\n    return () => {\r\n      if (animationIdRef.current) {\r\n        cancelAnimationFrame(animationIdRef.current);\r\n      }\r\n\r\n      activateIndicator.removeEventListener('click', handleGameAreaClick);\r\n      document.removeEventListener('keydown', handleKeyDown);\r\n      window.removeEventListener('keyup', handleKeyUp);\r\n      window.removeEventListener('mousedown', handleMouseDown);\r\n      window.removeEventListener('mouseup', handleMouseUp);\r\n      window.removeEventListener('mousemove', handleMouseMove);\r\n      window.removeEventListener('resize', handleResize);\r\n\r\n      if (gameArea && renderer.domElement) {\r\n        gameArea.removeChild(renderer.domElement);\r\n      }\r\n\r\n      geometry.dispose();\r\n      material.dispose();\r\n      renderer.dispose();\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"three-d-model-container\">\r\n      <div className=\"container\">\r\n        <h1>3D Interactive Model</h1>\r\n        <p style={{textAlign: 'center'}}>\r\n          Click viewport to activate. Click esc to deactivate viewport. W,S move in into screen/away from screen. \r\n          A/D move sideways. Space/Ctrl move up/down. Hold down and drag left mouse button to rotate.\r\n        </p>\r\n      </div>\r\n      <div ref={gameAreaRef} style={{width: '100%', height: '100vh', position: 'relative', overflow: 'hidden'}}></div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ThreeDModel;"],"names":["ThreeDModel","gameAreaRef","useRef","sceneRef","animationIdRef","stateRef","useEffect","gameArea","scene","THREE.Scene","camera","THREE.PerspectiveCamera","renderer","THREE.WebGLRenderer","geometry","THREE.TorusKnotGeometry","vertexShader","fragmentShader","material","THREE.ShaderMaterial","cube","THREE.Mesh","ambientLight","THREE.AmbientLight","directionalLight","THREE.DirectionalLight","movementSpeed","rotationSpeed","activateIndicator","exitIndicator","handleGameAreaClick","event","handleKeyDown","handleKeyUp","handleMouseDown","handleMouseUp","handleMouseMove","deltaX","deltaY","handleResize","adjustRotation","deltaTime","qx","THREE.Quaternion","qy","THREE.Vector3","animate","jsxs","jsx"],"mappings":"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"}